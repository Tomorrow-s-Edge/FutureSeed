name: Notify Discord

on:
  push: # Trigger on all branches
    branches:
      - '**'
  pull_request: # Trigger on all pull request events
    types: [opened, reopened, synchronize]

jobs:
  discord:
    runs-on: ubuntu-latest
    steps:
      - name: Send push or PR notification to Discord
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}    
        with:
          # args: |
          #   -w "$DISCORD_WEBHOOK" -m "ğŸ“¦ **New push to `${{ github.ref_name }}`**
          #   ğŸ‘¤ By: `${{ github.actor }}`
          #   ğŸ’¬ Message: _${{ github.event.head_commit.message }}_ 'Test notification from GitHub Actions'
          #   ğŸ”— [View Commit](${{ github.event.head_commit.url }})"

            
          args: |
            -w "$DISCORD_WEBHOOK" -m "${{
              github.event_name == 'push' 
                && format('ğŸ“¦ **New push to `{0}`**\nğŸ‘¤ By: `{1}`\nğŸ’¬ Message: _{2}_\nğŸ”— [View Commit]({3})',
                  github.ref_name, github.actor, github.event.head_commit.message, github.event.head_commit.url)
                || format('ğŸ“¬ **New Pull Request**\nğŸ”€ `{0}` â†’ `{1}`\nğŸ‘¤ By: `{2}`\nğŸ“ Title: _{3}_\nğŸ”— [View PR]({4})',
                  github.head_ref, github.base_ref, github.actor, github.event.pull_request.title, github.event.pull_request.html_url)
            }}"